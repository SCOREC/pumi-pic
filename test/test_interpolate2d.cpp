#include <iostream>
#include "pumipic_utils.hpp"
#include "pumipic_adjacency.hpp"
#include "GitrmInputOutput.hpp"

namespace o = Omega_h;
namespace p = pumipic;

void getStoredTempGridDataAndGrid(o::Reals& data, o::Real& rMin, o::Real& zMin,
 o::Real& dr, o::Real& dz, int& nR, int& nZ);
void getTempGradientPositionsAndReference(o::Reals& positions, o::Reals& results);

void testInterpolate2dVector(o::Reals& positions, o::Reals& data_d,
  o::Real rMin, o::Real zMin, o::Real dr, o::Real dz, int nR, int nZ, 
  bool symm, o::Write<o::Real>& data3d, int nPts=0) {
  if(nPts < 1)
    nPts = positions.size()/3;
  data3d = o::Write<o::Real>(nPts*3);
  auto lambda = OMEGA_H_LAMBDA(o::LO i) {
    auto fv = o::zero_vector<3>();
    auto pos= o::zero_vector<3>();
    // coords' size is 3* nverts
    for(o::LO j=0; j<3; ++j)
      pos[j] = positions[3*i+j];
    pumipic::interp2dVector(data_d, rMin, zMin, dr, dz, nR, nZ, pos, fv, symm);
    for(int j=0; j<3; ++j) //components
      data3d[3*i+j] = fv[j]; 
  };
  o::parallel_for(nPts, lambda, "interpolate2d_test");
}

void getDataFromNcFile(const std::string fileName, Field3StructInput& fs, 
   o::Reals& readInData_d, o::Real& rMin, o::Real& zMin, o::Real& dr, 
   o::Real& dz, int& nR, int& nZ, bool debug=false) {
  readInputDataNcFileFS3(fileName, fs);
  nR = fs.getNumGrids(0);
  nZ = fs.getNumGrids(1);
  rMin = fs.getGridMin(0);
  zMin = fs.getGridMin(1);
  dr = fs.getGridDelta(0);
  dz = fs.getGridDelta(1);
  readInData_d = o::Reals(fs.data);
  if(debug){
    printf(" %s dr%.5f , dz%.5f , rMin%.5f , zMin%.5f nR %d nZ %d\n",
        fileName.c_str(), dr, dz, rMin, zMin, nR, nZ);
    printf("data size %d \n", fs.data.size());
    for(int i=0; i<12 &&  i<fs.data.size(); ++i) {
      if(i%18==0) printf("\n");
      printf(" %g,", fs.data[i]);
    }
    printf("\n");
  }
}

int checkResult(o::Reals& positions, o::Write<o::Real>& data3d, 
   o::Reals& results, int nPts=0, o::Real tol=1.0e-6, bool debug=false) {
  o::Write<o::LO> status_d(1,0,"status");
  if(nPts < 1)
    nPts = positions.size()/3;
  auto lambda = OMEGA_H_LAMBDA(int i) {
    auto x = positions[3*i+0];
    auto y = positions[3*i+1];
    auto z = positions[3*i+2];
    auto valx = data3d[3*i+0];
    auto valy = data3d[3*i+1];
    auto valz = data3d[3*i+2];
    auto xx = results[3*i+0];
    auto yy = results[3*i+1];
    auto zz = results[3*i+2];
//    if(debug)
      printf("i %d pos: %.8f %.8f %.8f => data3d %.8f %.8f %.8f (%.8f %.8f %.8f)\n",
        i,x, y, z, valx, valy, valz, xx, yy, zz);
    if(!(p::almost_equal(valx, xx, tol) && p::almost_equal(valy, yy, tol) && 
      p::almost_equal(valz, zz, tol))) {
    //  if(debug)
        printf("Test failed: i %d pos: %g %g %g => data3d %g %g %g (%g %g %g)\n",
          i,x, y, z, valx, valy, valz, xx, yy, zz);
      Kokkos::atomic_increment(&status_d[0]);
    }
  };
  o::parallel_for(nPts, lambda, "checkResult");
  auto status = o::HostWrite<o::LO>(status_d);
  return status[0];
}


int testTempGradient_file(std::string fileName, bool symm=true, int nPts=0, 
  o::Real tol=1.0e-6, bool debug=false) {
  o::Reals positions;
  o::Reals results;
  getTempGradientPositionsAndReference(positions, results);
  Field3StructInput fs({"gradTiR", "gradTiT", "gradTiZ"}, 
    {"gridx_gradTi", "gridz_gradTi"}, {"nX_gradTi", "nZ_gradTi"});
  o::Write<o::Real> data3d;
  o::Real rMin=0;
  o::Real zMin=0;
  o::Real dr=0;
  o::Real dz=0;
  int nR=0;
  int nZ=0;
  o::Reals readInData_d;
  if(debug)
    std::cout << "getting data from file\n";
  getDataFromNcFile(fileName, fs, readInData_d, rMin, zMin, dr, dz, nR, nZ, debug);
  if(debug)
    std::cout << "calling interp2dVector\n";
  testInterpolate2dVector(positions, readInData_d, rMin, zMin, dr, dz, nR, 
    nZ, symm, data3d, nPts);
  if(debug)
    std::cout << "checking result\n";
  return checkResult(positions, data3d, results, nPts, tol, debug);
}


int testTempGradient_data(bool symm=true, int nPts=0, o::Real tol=1.0e-6, 
  bool debug=false) {
  o::Reals positions;
  o::Reals results;
  getTempGradientPositionsAndReference(positions, results);
  o::Write<o::Real> data3d;
  o::Real rMin=0;
  o::Real zMin=0;
  o::Real dr=0;
  o::Real dz=0;
  int nR=0;
  int nZ=0;
  o::Reals readInData_d;
  getStoredTempGridDataAndGrid(readInData_d, rMin, zMin, dr, dz, nR, nZ);
  if(debug)
    std::cout << "calling interp2dVector\n";
  testInterpolate2dVector(positions, readInData_d, rMin, zMin, dr, dz, nR, 
    nZ, symm, data3d, nPts);
  if(debug)
    std::cout << "checking result\n";
  return checkResult(positions, data3d, results, nPts, tol, debug);
}


int main(int argc, char** argv) {
  auto lib = Omega_h::Library(&argc, &argv);
  const auto world = lib.world();
  std::string ncFile = "profiles.nc";
  if(argc > 1)
    ncFile = argv[1];
  int nPts = 0;
  bool symm = true;
  bool debug = false;

  o::Real tol = 1.0e-3; //TODO

  auto stat = testTempGradient_file(ncFile, symm, nPts, tol, debug);
  std::cout << "mis-matched cases " << stat << " using tolerance " << tol << "\n";
  if(stat)
    stat = 1;

  //auto stat2 = testTempGradient_data(symm, nPts, tol, debug);

  return stat;
}

void getTempGradientPositionsAndReference(o::Reals& positions, o::Reals& results) {
  positions = o::Reals(o::HostWrite<o::Real>(
    {-0.00594345,0.0192005,0.00165384, 0.0113458, -0.0145734, 0.00617403,
      -0.00109902, -0.0297618, 0.00487984, 0.0189906, 0.00744021, 0.00383919,
      0.00763451, -0.0121241, 0.00832174, 0.0141843, -0.0188253, 0.00716646,
      0.0149736, -0.0147498, 0.0062472, -0.00599064, -0.0201362, 0.00482855,
      0.0172442, 0.00414935, 0.0037038, 0.00729308, -0.0117277, 0.00803973,
      .00700167, -0.0167152, 0.00688208, 0.00115834, -0.0103882, 0.00654887,
      0.0236956, -0.0505513, 0.00409376, 0.0216041, 0.00953564, 0.00436738,
      0.00137706, -0.00957907, 0.00943867, 0.0199658, -0.0202374, 0.00732015
     }));
  results = o::Reals(o::HostWrite<o::Real>(
    {
     53.82019252 , -173.86780515 , 0.00000000 ,
    -111.80874267 , 143.61556968 , 0.00000000 ,  0.36637111 , 9.92144246 , 0.00000000 ,
    -169.46531779 , -66.39377124 , 0.00000000 ,  -96.98329583 , 154.01580153 , 0.00000000 ,
   -109.52689016 , 145.36329359 , 0.00000000 ,  -129.66388697 , 127.72589090 , 0.00000000 ,
    51.90009341 , 174.45058640 , 0.00000000 ,  -176.95646045 , -42.57978272 , 0.00000000 ,
   -96.11527205 , 154.55898962 , 0.00000000 ,  -70.31930853 , 167.87442223 , 0.00000000 ,
   -20.16977795 , 180.88617097 , 0.00000000 ,  -2.50284636 , 5.33947810 , 0.00000000 ,
   -166.50906088 , -73.49394149 , 0.00000000 ,  -25.89859913 , 180.15518132 , 0.00000000 ,
   -7.16392949 , 7.26138230 , 0.00000000 }));
/*
 float:
    53.82027054 , -173.86810303 , 0.00000000 ,
    -111.80866241 , 143.61547852 , 0.00000000 ,  0.36637083 , 9.92145920 , 0.00000000 ,
    -169.46559143 , -66.39387512 , 0.00000000 ,  -96.98323059 , 154.01570129 , 0.00000000 ,
    -109.52681732 , 145.36320496 , 0.00000000 ,  -129.66378784 , 127.72579956 , 0.00000000 ,
    51.90004730 , 174.45046997 , 0.00000000 ,  -176.95634460 , -42.57975388 , 0.00000000 ,
    -96.11532593 , 154.55906677 , 0.00000000 ,  -70.31925964 , 167.87431335 , 0.00000000 ,
    -20.16978455 , 180.88626099 , 0.00000000 ,  -2.50283861 , 5.33946180 , 0.00000000 ,
    -166.50894165 , -73.49388885 , 0.00000000 ,  -25.89857674 , 180.15504456 , 0.00000000 ,
    -7.16392517 , 7.26137781 , 0.00000000}));
  
        {53.8203, -173.868, 0,  -111.809, 143.615, 0, 
      0.366372, 9.92146, 0,  -169.466, -66.3939, 0,
      -96.9832, 154.016, 0,  -109.527, 145.363, 0,
      -129.664, 127.726, 0,  51.9001, 174.45, 0,
      -176.956, -42.5798, 0, -96.1153, 154.559, 0,
      -70.3193, 167.874, 0,  -20.1699, 180.886, 0,
      -2.50284, 5.33946, 0,  -166.509, -73.4939, 0,
      -25.8987, 180.155, 0,  -7.16392, 7.26139, 0
  */
}

void getStoredTempGridDataAndGrid(o::Reals& data, o::Real& rMin, o::Real& zMin,
 o::Real& dr, o::Real& dz, int& nR, int& nZ) {
 dr = 0.00077; 
 dz = 0.02778;
 rMin = 0.00000; 
 zMin = -0.05000;
 nR = 100;
 nZ = 10; 
 data = o::Reals(o::HostWrite<o::Real>({
  -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0,
 -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0,
 -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0,
 -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0,
 -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0,
 -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0,
 -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0,
 -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0,
 -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0,
 -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0,
 -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -96.1455, 0, 0, -10.2054, 0, 0,
 -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0, -9.45131, 0, 0, -9.30731, 0, 0,
 -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0, -8.61955, 0, 0, -8.48822, 0, 0,
 -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0, -7.86098, 0, 0, -7.74121, 0, 0,
 -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0, -7.16917, 0, 0, -7.05994, 0, 0,
 -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0, -6.53824, 0, 0, -6.43863, 0, 0,
 -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0, -5.96284, 0, 0, -5.87199, 0, 0,
 -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0, -5.43808, 0, 0, -5.35523, 0, 0,
 -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0, -4.9595, 0, 0, -4.88394, 0, 0,
 -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0, -4.52304, 0, 0, -4.45412, 0, 0,
 -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0, -4.12499, 0, 0, -4.06214, 0, 0,
 -4.00025, 0, 0, -3.96954, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0,
 -9.74604, 0, 0, -9.59754, 0, 0, -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0,
 -8.88833, 0, 0, -8.75291, 0, 0, -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0,
 -8.10611, 0, 0, -7.9826, 0, 0, -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0,
 -7.39273, 0, 0, -7.28009, 0, 0, -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0,
 -6.74213, 0, 0, -6.6394, 0, 0, -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0,
 -6.14879, 0, 0, -6.0551, 0, 0, -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0,
 -5.60766, 0, 0, -5.52222, 0, 0, -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0,
 -5.11416, 0, 0, -5.03623, 0, 0, -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0,
 -4.66408, 0, 0, -4.59302, 0, 0, -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0,
 -4.25362, 0, 0, -4.18881, 0, 0, -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0,
 -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0,
 -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0,
 -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0,
 -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0,
 -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0,
 -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0,
 -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0,
 -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0,
 -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0,
 -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -96.1455, 0, 0, -10.2054, 0, 0,
 -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0, -9.45131, 0, 0, -9.30731, 0, 0,
 -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0, -8.61955, 0, 0, -8.48822, 0, 0,
 -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0, -7.86098, 0, 0, -7.74121, 0, 0,
 -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0, -7.16917, 0, 0, -7.05994, 0, 0,
 -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0, -6.53824, 0, 0, -6.43863, 0, 0,
 -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0, -5.96284, 0, 0, -5.87199, 0, 0,
 -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0, -5.43808, 0, 0, -5.35523, 0, 0,
 -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0, -4.9595, 0, 0, -4.88394, 0, 0,
 -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0, -4.52304, 0, 0, -4.45412, 0, 0,
 -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0, -4.12499, 0, 0, -4.06214, 0, 0,
 -4.00025, 0, 0, -3.96954, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0,
 -9.74604, 0, 0, -9.59754, 0, 0, -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0,
 -8.88833, 0, 0, -8.75291, 0, 0, -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0,
 -8.10611, 0, 0, -7.9826, 0, 0, -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0,
 -7.39273, 0, 0, -7.28009, 0, 0, -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0,
 -6.74213, 0, 0, -6.6394, 0, 0, -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0,
 -6.14879, 0, 0, -6.0551, 0, 0, -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0,
 -5.60766, 0, 0, -5.52222, 0, 0, -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0,
 -5.11416, 0, 0, -5.03623, 0, 0, -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0,
 -4.66408, 0, 0, -4.59302, 0, 0, -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0,
 -4.25362, 0, 0, -4.18881, 0, 0, -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0,
 -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0,
 -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0,
 -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0,
 -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0,
 -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0,
 -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0,
 -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0,
 -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0,
 -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0,
 -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -96.1455, 0, 0, -10.2054, 0, 0,
 -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0, -9.45131, 0, 0, -9.30731, 0, 0,
 -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0, -8.61955, 0, 0, -8.48822, 0, 0,
 -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0, -7.86098, 0, 0, -7.74121, 0, 0,
 -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0, -7.16917, 0, 0, -7.05994, 0, 0,
 -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0, -6.53824, 0, 0, -6.43863, 0, 0,
 -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0, -5.96284, 0, 0, -5.87199, 0, 0,
 -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0, -5.43808, 0, 0, -5.35523, 0, 0,
 -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0, -4.9595, 0, 0, -4.88394, 0, 0,
 -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0, -4.52304, 0, 0, -4.45412, 0, 0,
 -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0, -4.12499, 0, 0, -4.06214, 0, 0,
 -4.00025, 0, 0, -3.96954, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0,
 -9.74604, 0, 0, -9.59754, 0, 0, -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0,
 -8.88833, 0, 0, -8.75291, 0, 0, -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0,
 -8.10611, 0, 0, -7.9826, 0, 0, -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0,
 -7.39273, 0, 0, -7.28009, 0, 0, -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0,
 -6.74213, 0, 0, -6.6394, 0, 0, -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0,
 -6.14879, 0, 0, -6.0551, 0, 0, -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0,
 -5.60766, 0, 0, -5.52222, 0, 0, -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0,
 -5.11416, 0, 0, -5.03623, 0, 0, -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0,
 -4.66408, 0, 0, -4.59302, 0, 0, -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0,
 -4.25362, 0, 0, -4.18881, 0, 0, -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0, -182.007, 0, 0,
 -96.1455, 0, 0, -10.2054, 0, 0, -10.05, 0, 0, -9.89683, 0, 0, -9.74604, 0, 0, -9.59754, 0, 0,
 -9.45131, 0, 0, -9.30731, 0, 0, -9.1655, 0, 0, -9.02585, 0, 0, -8.88833, 0, 0, -8.75291, 0, 0,
 -8.61955, 0, 0, -8.48822, 0, 0, -8.35889, 0, 0, -8.23153, 0, 0, -8.10611, 0, 0, -7.9826, 0, 0,
 -7.86098, 0, 0, -7.74121, 0, 0, -7.62326, 0, 0, -7.50711, 0, 0, -7.39273, 0, 0, -7.28009, 0, 0,
 -7.16917, 0, 0, -7.05994, 0, 0, -6.95237, 0, 0, -6.84644, 0, 0, -6.74213, 0, 0, -6.6394, 0, 0,
 -6.53824, 0, 0, -6.43863, 0, 0, -6.34053, 0, 0, -6.24392, 0, 0, -6.14879, 0, 0, -6.0551, 0, 0,
 -5.96284, 0, 0, -5.87199, 0, 0, -5.78253, 0, 0, -5.69442, 0, 0, -5.60766, 0, 0, -5.52222, 0, 0,
 -5.43808, 0, 0, -5.35523, 0, 0, -5.27363, 0, 0, -5.19328, 0, 0, -5.11416, 0, 0, -5.03623, 0, 0,
 -4.9595, 0, 0, -4.88394, 0, 0, -4.80952, 0, 0, -4.73624, 0, 0, -4.66408, 0, 0, -4.59302, 0, 0,
 -4.52304, 0, 0, -4.45412, 0, 0, -4.38626, 0, 0, -4.31943, 0, 0, -4.25362, 0, 0, -4.18881, 0, 0,
 -4.12499, 0, 0, -4.06214, 0, 0, -4.00025, 0, 0, -3.96954, 0, 0}));
}


/*

#pos ITG ETG
-0.00594345 0.0192005 0.00165384   53.8203 -173.868 0 
 0.0113458 -0.0145734 0.00617403  -111.809 143.615 0 
 -0.00109902 -0.0297618 0.00487984   0.366372 9.92146 0 
 0.0189906 0.00744021 0.00383919  -169.466 -66.3939 0 
 0.00763451 -0.0121241 0.00832174  -96.9832 154.016 0  
 0.0141843 -0.0188253 0.00716646  -109.527 145.363 0   
 0.0149736 -0.0147498 0.0062472  -129.664 127.726 0
 -0.00599064 -0.0201362 0.00482855  51.9001 174.45 0
 0.0172442 0.00414935 0.0037038   -176.956 -42.5798 0
 0.00729308 -0.0117277 0.00803973  -96.1153 154.559 0
 0.00700167 -0.0167152 0.00688208  -70.3193 167.874 0
 0.00115834 -0.0103882 0.00654887   -20.1699 180.886 0
 0.0236956 -0.0505513 0.00409376   -2.50284 5.33946 0
 0.0216041 0.00953564 0.00436738   -166.509 -73.4939 0
 0.00137706 -0.00957907 0.00943867  -25.8987 180.155 0
 0.0199658 -0.0202374 0.00732015    -7.16392 7.26139 0

Collected from :
gradIonTemp  ptcl 0  timestep 3000  -111.809 143.615 0
gradIonTemp ptcl 2  timestep 3000  0.366372 9.92146 0
gradIonTemp ptcl 5  timestep 3000  -169.466 -66.3939 0
gradIonTemp ptcl 6  timestep 3000  -96.9832 154.016 0
gradIonTemp ptcl 8  timestep 3000  -109.527 145.363 0
gradElTemp ptcl 0  timestep 3000  -111.809 143.615 0
gradElTemp ptcl 2  timestep 3000  0.366372 9.92146 0
gradElTemp ptcl 5  timestep 3000  -169.466 -66.3939 0
gradElTemp ptcl 6  timestep 3000  -96.9832 154.016 0
gradElTemp ptcl 8  timestep 3000  -109.527 145.363 0
postions   ptcl 0  timestep 3000  0.0113458 -0.0145734 0.00617403
postions   ptcl 2  timestep 3000  -0.00109902 -0.0297618 0.00487984
postions   ptcl 5  timestep 3000  0.0189906 0.00744021 0.00383919
postions   ptcl 6  timestep 3000  0.00763451 -0.0121241 0.00832174
postions   ptcl 8  timestep 3000  0.0141843 -0.0188253 0.00716646
ptcl 0  timestep 3000 unitB   0.992272 -0.123562 -0.011313
ptcl 2  timestep 3000 unitB  0.680488 -0.732672 -0.011313
ptcl 5  timestep 3000 unitB  0.400412 0.916265 -0.011313
ptcl 6  timestep 3000 unitB   0.975081 -0.22156 -0.011313
ptcl 8  timestep 3000 unitB   0.990197 -0.139218 -0.011313

gradIonTemp ptcl 0  timestep 2000  -129.664 127.726 0
gradIonTemp ptcl 2  timestep 2000  51.9001 174.45 0
gradIonTemp ptcl 5  timestep 2000  -176.956 -42.5798 0
gradIonTemp ptcl 6  timestep 2000  -96.1153 154.559 0
gradIonTemp ptcl 8  timestep 2000  -70.3193 167.874 0
gradElTemp ptcl 0  timestep 2000  -129.664 127.726 0
gradElTemp ptcl 2  timestep 2000  51.9001 174.45 0
gradElTemp ptcl 5  timestep 2000  -176.956 -42.5798 0
gradElTemp ptcl 6  timestep 2000  -96.1153 154.559 0
gradElTemp ptcl 8  timestep 2000  -70.3193 167.874 0
postions   ptcl 0  timestep 2000  0.0149736 -0.0147498 0.0062472
postions   ptcl 2  timestep 2000  -0.00599064 -0.0201362 0.00482855
postions   ptcl 5  timestep 2000  0.0172442 0.00414935 0.0037038
postions   ptcl 6  timestep 2000  0.00729308 -0.0117277 0.00803973
postions   ptcl 8  timestep 2000  0.00700167 -0.0167152 0.00688208
ptcl 0  timestep 2000 unitB   0.999908 0.00752896 -0.011313
ptcl 2  timestep 2000 unitB   0.476084 -0.879327 -0.011313
ptcl 5  timestep 2000 unitB   0.522026 0.852854 -0.011313
ptcl 6  timestep 2000 unitB   0.973819 -0.227042 -0.011313
ptcl 8  timestep 2000 unitB   0.925335 -0.378982 -0.011313

gradIonTemp ptcl 0  timestep 5000  -20.1699 180.886 0
gradIonTemp ptcl 2  timestep 5000  -2.50284 5.33946 0
gradIonTemp ptcl 5  timestep 5000  -166.509 -73.4939 0
gradIonTemp ptcl 6  timestep 5000  -25.8987 180.155 0
gradIonTemp ptcl 8  timestep 5000  -7.16392 7.26139 0
gradElTemp ptcl 0  timestep 5000  -20.1699 180.886 0
gradElTemp ptcl 2  timestep 5000  -2.50284 5.33946 0
gradElTemp ptcl 5  timestep 5000  -166.509 -73.4939 0
gradElTemp ptcl 6  timestep 5000  -25.8987 180.155 0
gradElTemp ptcl 8  timestep 5000  -7.16392 7.26139 0
postions   ptcl 0  timestep 5000  0.00115834 -0.0103882 0.00654887
postions   ptcl 2  timestep 5000  0.0236956 -0.0505513 0.00409376
postions   ptcl 5  timestep 5000  0.0216041 0.00953564 0.00436738
postions   ptcl 6  timestep 5000  0.00137706 -0.00957907 0.00943867
postions   ptcl 8  timestep 5000  0.0199658 -0.0202374 0.00732015
ptcl 0  timestep 5000 unitB   0.781062 -0.62435 -0.011313
ptcl 2  timestep 5000 unitB   0.940314 -0.34012 -0.011313
ptcl 5  timestep 5000 unitB   0.361345 0.932363 -0.011313
ptcl 6  timestep 5000 unitB   0.800478 -0.599256 -0.011313
ptcl 8  timestep 5000 unitB  0.999913 -0.00675602 -0.011313
 */
